<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Select a City</title>
<meta charset="UTF-8">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
:root {
--primary: #2563eb;
--secondary: #7c3aed;
--glass: rgba(255, 255, 255, 0.1);
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Poppins', sans-serif;
background: linear-gradient(135deg, #6366f1, #8b5cf6, #ec4899);
min-height: 100vh;
display: flex;
justify-content: center;
align-items: center;
position: relative;
overflow: hidden;
}

.particles {
position: absolute;
width: 100%;
height: 100%;
z-index: 1;
}

.particle {
position: absolute;
background: rgba(255, 255, 255, 0.3);
border-radius: 50%;
animation: float 15s infinite linear;
}

.container {
position: relative;
z-index: 2;
background: var(--glass);
backdrop-filter: blur(25px) saturate(180%);
-webkit-backdrop-filter: blur(25px) saturate(180%);
border-radius: 24px;
padding: 2.5rem;
width: 95%;
max-width: 500px;
box-shadow: 0 24px 48px -12px rgba(0, 0, 0, 0.25);
border: 1px solid rgba(255, 255, 255, 0.15);
transform: translateY(0);
transition: transform 0.3s ease;
}

.container:hover {
transform: translateY(-4px);
}

h1 {
color: white;
font-weight: 600;
margin-bottom: 2rem;
font-size: 1.75rem;
text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
position: relative;
display: inline-block;
}

h1::after {
content: '';
position: absolute;
bottom: -8px;
left: 50%;
transform: translateX(-50%);
width: 60px;
height: 3px;
background: linear-gradient(90deg, var(--primary), var(--secondary));
border-radius: 2px;
}

.input-group {
position: relative;
margin-bottom: 1.5rem;
}

input, select {
width: 100%;
padding: 1rem 1.5rem;
border: none;
background: rgba(255, 255, 255, 0.9);
border-radius: 12px;
font-size: 1rem;
transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

input:focus, select:focus {
outline: none;
background: white;
box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.3);
transform: scale(1.02);
}

.search-icon {
position: absolute;
right: 1.5rem;
top: 50%;
transform: translateY(-50%);
color: var(--primary);
pointer-events: none;
}

button {
width: 100%;
padding: 1rem;
background: linear-gradient(135deg, var(--primary), var(--secondary));
border: none;
border-radius: 12px;
color: white;
font-weight: 600;
cursor: pointer;
transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

button:hover {
transform: translateY(-2px);
box-shadow: 0 8px 12px -2px rgba(0, 0, 0, 0.2);
background: linear-gradient(135deg, var(--secondary), var(--primary));
}

button:active {
transform: translateY(0);
}

.loading {
position: relative;
overflow: hidden;
}

.loading::after {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(
90deg,
transparent,
rgba(255, 255, 255, 0.2),
transparent
);
animation: loading 1.5s infinite;
}

@keyframes float {
0% { transform: translateY(0) rotate(0deg); }
50% { transform: translateY(-20px) rotate(180deg); }
100% { transform: translateY(0) rotate(360deg); }
}

@keyframes loading {
100% { left: 100%; }
}

@media (max-width: 480px) {
.container {
padding: 1.5rem;
border-radius: 16px;
}

h1 {
font-size: 1.5rem;
}
}
</style>
</head>
<body>
<div class="particles">
<!-- Animated background particles -->
<div class="particle" style="width: 10px; height: 10px; top: 20%; left: 30%"></div>
<div class="particle" style="width: 8px; height: 8px; top: 60%; left: 70%"></div>
<div class="particle" style="width: 12px; height: 12px; top: 80%; left: 40%"></div>
</div>

<div class="container">
<h1>Discover City Weather</h1>
<form th:action="@{/weather/select}" method="post" onsubmit="return validateSelection()">
<div class="input-group">
<input type="text" id="searchInput" placeholder="Search city..." autocomplete="off">
<i class="fas fa-search search-icon"></i>
</div>
<select name="city" id="cityDropdown" required class="loading">
<option value="" disabled selected>Loading cities...</option>
</select>
<button type="submit">
<span>Get Weather</span>
<i class="fas fa-arrow-right"></i>
</button>
</form>
</div>

<script>
// Existing JavaScript remains unchanged
const searchInput = document.getElementById('searchInput');
const cityDropdown = document.getElementById('cityDropdown');
let allCities = [];

async function loadCityData() {
try {
const response = await fetch('/data/country.json');
if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
const data = await response.json();

allCities = data
.flatMap(country => Array.isArray(country.city) ? country.city : [])
.filter(city => typeof city === 'string')
.sort((a, b) => a.localeCompare(b));

const uniqueCities = [...new Set(allCities)];
populateDropdown(uniqueCities);
cityDropdown.classList.remove('loading');
cityDropdown.disabled = false;
} catch (error) {
console.error("Error loading city data:", error);
cityDropdown.innerHTML = '<option value="" disabled selected>Error loading cities</option>';
}
}

function populateDropdown(citiesToDisplay) {
cityDropdown.innerHTML = '<option value="" disabled selected>Select a city...</option>';
citiesToDisplay.forEach(city => {
const option = document.createElement('option');
option.value = city;
option.text = city;
cityDropdown.appendChild(option);
});
}

loadCityData();

searchInput.addEventListener('input', function () {
const input = searchInput.value.toLowerCase();
const filteredCities = allCities.filter(city => city.toLowerCase().includes(input));
populateDropdown(filteredCities);

if (filteredCities.includes(searchInput.value)) {
cityDropdown.value = searchInput.value;
} else {
cityDropdown.selectedIndex = 0;
}
});

function validateSelection() {
const selectedValue = cityDropdown.value;
if (!selectedValue) {
alert("Please select a city from the list.");
return false;
}
return true;
}

// Add animated particles
function createParticles() {
const particlesContainer = document.querySelector('.particles');
for (let i = 0; i < 12; i++) {
const particle = document.createElement('div');
particle.className = 'particle';
particle.style.cssText = `
width: ${Math.random() * 6 + 4}px;
height: ${Math.random() * 6 + 4}px;
top: ${Math.random() * 100}%;
left: ${Math.random() * 100}%;
animation-duration: ${Math.random() * 10 + 10}s;
animation-delay: ${Math.random() * 5}s;
`;
particlesContainer.appendChild(particle);
}
}

createParticles();
</script>
</body>
</html>